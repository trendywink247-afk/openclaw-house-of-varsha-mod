version: "3.9"
services:
  openclaw:
    image: ghcr.io/openclaw-ai/openclaw:latest
    container_name: openclaw
    restart: unless-stopped
    user: root
    ports:
      - "${PORT}:${PORT}"
    env_file:
      - .env
    environment:
      HOME: /home/node
      TERM: xterm-256color
      XDG_CONFIG_HOME: /home/node/.openclaw
      NPM_CONFIG_PREFIX: /home/node/.npm-global
      OPENCLAW_GATEWAY_BIND: lan
      OPENCLAW_GATEWAY_PORT: ${PORT}
    volumes:
      - ./config:/home/node/.openclaw
      - ./agents:/home/node/.openclaw/agents
      - ./memory:/home/node/.openclaw/memory
      - ./workspace:/home/node/openclaw
    init: true
    command:
      - sh
      - -c
      - |
        chown -R node:node /home/node
        exec su node -s /bin/sh -c "node dist/index.js gateway --bind lan --port ${PORT}"
